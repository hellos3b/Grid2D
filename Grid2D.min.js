!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.returnExports=e()}(this,function(){function t(t){this.parent=t.parent,this.x=t.x,this.y=t.y,this.value=t.value||null,this.neighbors={top:null,right:null,bottom:null,left:null},this.get=function(){return this.value},this.set=function(t){this.value=t},this.setNeighbor=function(t,e){this.neighbors[t]=e},this.getNeighbors=function(){return this.neighbors},this.getNeighbor=function(t){try{return this.neighbors[t]}catch(e){return console.warn("[Grid2D] Neighbor "+t+" doesn't exist",this.neighbors),null}},this.findNeighbors=function(){var t=this.parent,e=this.x,i=this.y;this.setNeighbor("up",t.getCellAt(e,i-1,!0)),this.setNeighbor("right",t.getCellAt(e+1,i,!0)),this.setNeighbor("down",t.getCellAt(e-1,i,!0)),this.setNeighbor("bottom",t.getCellAt(e,i+1,!0))},this.call=function(t){t(this.value)}}function e(t){this.cells=[],this.cellsFlat=[],this.cellsMap={},t instanceof Array?this.initData(t):this.initSize(t)}return e.prototype={initData:function(e){var i=this;this.w=e[0].length,this.h=e.length;for(var s=0;s<this.h;s++){for(var n=[],h=0;h<this.w;h++){var r=new t({parent:i,x:h,y:s,value:e[s][h]});this.cellsFlat.push(r),n.push(r)}this.cells.push(n)}this.each(function(t){t.findNeighbors()})},initSize:function(e){var i=this;this.w=e.w,this.h=e.h;for(var s=0;s<e.h;s++){for(var n=[],h=0;h<e.w;h++){var r=new t({parent:i,x:h,y:s});this.cellsFlat.push(r),n.push(r)}this.cells.push(n)}this.each(function(t){t.findNeighbors()})},each:function(t){this.splice({startx:0,starty:0,endy:this.h-1,endx:this.w-1},t)},size:function(){return this.cellsFlat.length},splice:function(t,e){t.starty=t.starty<0?0:t.starty,t.starty=t.starty>this.h?this.h-1:t.starty,t.endy=t.endy<0?0:t.endy,t.endy=t.endy>this.h?this.h-1:t.endy,t.startx=t.startx<0?0:t.startx,t.startx=t.startx>this.w?this.w-1:t.startx,t.endx=t.endx<0?0:t.endx,t.endx=t.endx>this.w?this.w-1:t.endx;for(var i=t.starty;i<=t.endy;i++)for(var s=t.startx;s<=t.endx;s++){var n=this.getCellAt(s,i);e(n,n.get())}},getValueAt:function(t,e){return this.getCellAt(t,e).get()},getAllValues:function(){return this.cellsFlat.map(function(t){return t.get()})},getCellAt:function(t,e,i){try{return this.cells[e][t]}catch(s){return i||console.warn("[Grid2D] Could not find cell at ("+t+","+e+")",this),null}},getCellByIndex:function(t){return this.cellsFlat[t]}},e});